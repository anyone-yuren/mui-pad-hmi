import{r as n,j as u}from"./index-37af907f.js";import{L as E,a as l,I as O,K as j}from"./ReactKonvaCore-a5150e1f.js";import{u as L}from"./map-b36eff15.js";let a=0,o=9*40,g=[[0,0],[-o,0],[-o,o],[o,o],[o,-o],[-o,-o],[-o,0],[0,0]];const T=S=>{const[m,w]=n.useState({xAxios:[],yAxios:[]}),[c,I]=n.useState({count:5e3,gap:40}),[y,P]=n.useState(void 0),[A,W]=n.useState({x:0,y:0}),{agvPosition:h,setAgvPosition:v}=L(e=>({agvPosition:e.agvPosition,setAgvPosition:e.setAgvPosition})),x=n.useRef(null);return n.useEffect(()=>{console.log("监听store的agvPosition",h)},[h]),n.useEffect(()=>{if(!x.current)return;v({x:g[a][0],y:g[a][1]});function*e(s){for(;a<s.length;){const[t,r]=g[a];v({x:t,y:r}),new j.Tween({node:x.current,duration:5,x:t,y:r,easing:j.Easings.Linear}).play(),a++,a===s.length&&(a=0),yield new Promise(p=>setTimeout(p,5e3))}}function f(s){return s.done?s.value:Promise.resolve(s.value).then(()=>{f(i.next())})}const i=e(g);i.next(),f(i.next())},[x.current]),n.useEffect(()=>{const{count:e,gap:f}=c;let i=[],s=[],t=0;for(;t<e;){let d={x1:t,y1:e,x2:t,y2:-e},p={x1:-t,y1:e,x2:-t,y2:-e},b={x1:-e,y1:t,x2:e,y2:t},k={x1:-e,y1:-t,x2:e,y2:-t};i.push(Object.values(d)),i.push(Object.values(p)),s.push(Object.values(b)),s.push(Object.values(k)),t+=f}w({xAxios:i,yAxios:s});const r=new Image;r.src="../../../../../assets/agv.svg",r.onload=()=>P(r)},[]),u.jsxs(E,{children:[m.xAxios.map(e=>u.jsx(l,{points:e,strokeWidth:1,stroke:"#8f8f8f"})),m.yAxios.map(e=>u.jsx(l,{points:e,strokeWidth:1,stroke:"#8f8f8f"})),u.jsx(l,{points:[-c.count,0,c.count,0],strokeWidth:1,stroke:"white"}),u.jsx(l,{points:[0,c.count,0,-c.count],strokeWidth:1,stroke:"white"}),y&&u.jsx(O,{ref:x,image:y,...A,offsetX:23,offsetY:35,width:46,height:70})]})};export{T as default};
